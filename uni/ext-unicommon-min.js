/*!
 * uniGUI Library extension for Ext JS
 * by Farshad Mohajeri  
 * Copyright(c) 2009-2015 FMSoft Inc.
 * info@fmsoft.net
 * http://www.unigui.com
 !*/
var uniVars={mKeys:{},gNavigate:{},_docKeys_:{},_actFrm_:null,_mFrm_:null,_actPge_:{Id1:"",Id2:""},_mouseMove_:null,_mouseUp_:null,_mouseThis_:null,_maskObjs:[],_maskCnt:0,_actCnt:null,_extVer:null,_dlfrmarr:[],_dlfrmid:0,_vport:null,_timers:{},_globalKbEn:true};function _dts_(a){if(a&&a.getDate){return(Ext.Date.format(a,"YmdHis"))}else{return("")}}function _ts_(a){if(a&&a.getDate){return(Ext.Date.format(a,"H:i:s"))}else{return(a)}}function _xl_(a){var b=encodeURIComponent;if(a==undefined||a===null){a=""}if(a&&a.getDate){return("\3d\3"+_dts_(a))}else{if(typeof a=="boolean"){return("\3b\3"+b(a))}else{return(b(a))}}}function _ds_(a){if(a&&a.getDate){return(Ext.Date.format(a,"Ymd"))}else{return("")}}function _ueval(ss){eval(ss)}function applyAttribs(a,b){if(a&&a.dom&&b.uniAttribs){a.dom.style.backgroundColor=b.uniAttribs.color;a.dom.style.opacity=b.uniAttribs.opacity}}Ext.override(Ext.LoadMask,{getMaskEl:function(){var a=this.callParent(arguments);applyAttribs(a,this);return(a)}});function _pss_(c,b){if(typeof c.shiftKey=="boolean"){var a=0;if(c.shiftKey){a|=1}if(c.altKey){a|=2}if(c.ctrlKey){a|=4}return(a)}else{if(b){return _pss_(b)}}return null}function _gkc_(b,a){if(b&&b.getKey){return(b.getKey())}if(a&&a.getKey){return(a.getKey())}if(a.browserEvent){return a.browserEvent.keyCode}return null}function _hde_(d,c){if(typeof d=="object"&&d){if(!d.hasMask){return}if(d.noAutoHide&&c!==true){return}d.noAutoHide=false;var b=0;if(typeof d.UIMask=="object"){if(d.UICnt){b=d.UICnt}if(--b<=0){d.UICnt=0;d.hasMask=false;var a=d.UIMask;if(a.mustWaitData!==true){d.maskActive=false;a.hide();a.destroy()}d.UIMask=undefined}else{d.UICnt=b}}}}function createMask(a){return null}function _shm_(i,g,k,f){var c="Loading...";var d=0;var l=null;var b=false,a=false;var j=null;if(typeof i=="object"&&i){if(Ext.isObject(f)){j=f}else{if(Ext.isObject(i.uniMask)){j=i.uniMask}else{if(i.config&&Ext.isObject(i.config.uniMask)){j=i.config.uniMask}}}if(j&&(j.ldMask||g)){if(typeof j.maskMsg=="string"&&j.maskMsg!=""){c=j.maskMsg}if(i.UICnt!=undefined){d=i.UICnt}i.noAutoHide=k;try{if(d++==0){if(typeof j.targetObj=="object"&&j.targetObj){l=j.targetObj}else{if(i.uwindow&&i.uwindow.hidden!==true){l=i.uwindow}else{if(i.uform){l=i.uform}}}if(l&&(l.uform==l)){a=true}try{i.UIMask=createMask({useTargetEl:a,target:l,msg:c,uniAttribs:j.maskAttribs,useMsg:j.maskUseMsg});i.UIMask.show();i.UIMask.isBody=b}catch(h){_log(h)}}}finally{i.UICnt=d;i.hasMask=true;if(j.maskWaitData){uniVars._maskObjs.push({o:i,c:0,u:i.UIMask})}}}}}function _ssevt_(d,c,a){if(!d.hasListeners){d.hasListeners={}}d.hasListeners[c]=!a;if(!d.uniSuspendedEvents){d.uniSuspendedEvents={}}d.uniSuspendedEvents[c]=a}function _hreq_(d,a,c){if(d&&d.exEvents){var b=d.exEvents.ajaxrequest;if(b){b(d,a,c)}}}function _hcbk_(c,b){if(c&&c.exEvents){var a=c.exEvents.ajaxcallback;if(a){a(c,b)}}}function _aexc_(a){var b=a.responseText;if(b&&b.substring(0,3)=="@@@"){a.responseText=b.substring(3);return(true)}return(false)}function obj2str(i,f,d,b){var a="",h=encodeURIComponent;if(!d){d="="}if(!b){b="&"}if(Ext.isObject(i)){for(var c in i){a=a+b+h(c)+d;var g=_xl_(i[c]);if(f){a=a+btoa(g)}else{a=a+g}}}if(f){a=btoa(a)}return a}function ajaxRequest(j,a,c,d,l){var m="",k=encodeURIComponent,b=d;if(!j){return null}if(!j.owner){return null}if(b==undefined&&uniVars._uniAsync===false){b=false}if(Ext.isObject(c)){m=obj2str(c)}else{if(c&&c.length){var h=c.length;for(var f=0;f<h;f++){m=m+"&"+k(c[f])}}}if(j.getXType&&j.getXType()=="combo"){_asst_(j)}var g="Ajax=1&IsEvent=1&Obj="+j.nm+"&Evt="+a+m+_gv_(j.uform);if(b!==false){b=true}if(l&&j.showMask&&!(j.uniMask&&j.uniMask.ldMask)){j.mevent=a;_shm_(j,true)}return Ext.Ajax.request({url:j.owner.appRoot+"HandleEvent",event:a,params:g,success:j.owner.ajxS,failure:j.owner.ajxF,obj:j,async:b})}function _cdo_(g,c,f,b,d){if(b){if(f){if(g){if(!b[g]){b[g]={}}var a=b[g]}else{var a=b}a.owner=b;a[f]=c;c.uname=f}else{if(g){c.uname=g;b[g]=c}}c.owner=b;c.uform=b.form;c.uwindow=b.window;if(b.form&&b.window&&!b.window.uform){b.window.uform=b.form;b.window.uwindow=b.window}}else{if(c){_ueval(g+"="+c.nm+";")}else{_ueval(g+"={};")}_ueval(g+'.uname="'+g+'";')}if(c){c.monitorUniEvents=true;c.retfalse={};if(c.uniAfterCreate){c.uniAfterCreate()}if(d){d(c)}}}function _coe_(b,g,h,f,d){var c="On"+f.charAt(0).toUpperCase()+f.substring(1);var a=null;if(g){if(h){a=b[g][h]}else{a=b[g]}}else{if(h){a=b[h]}else{a=b}}if(a.on){a.on(f,d)}a[c]=d}function _coxe_(a,f,g,c,b){if(f){if(g){var d=a[f][g]}else{var d=a[f]}}else{if(g){var d=a[g]}else{var d=a}}if(!d.exEvents){d.exEvents=[]}d.exEvents[c]=b}function _gv_(c){var a="";if(c){if(c.getForm){var b=c.getForm()}else{var b=c}a=uniGetValues(b)}if(a!=""){return('&"_fp_='+_S_ID+a+'"')}else{return("&"+_S_ID)}}function _sps_(c,g,d,f,b){if(b&&b.getPosition){var a=b.getPosition();if(g!==null){g+=a[0]}if(d!==null){d+=a[1]}}if(f){if(g!==null){c.setLeft(g)}if(d!==null){c.setTop(d)}}else{_ssevt_(c,"move",true);try{if(g!==null&&d!==null){c.setPosition(g,d)}else{if(g===null){c.setLocalY(d)}else{if(d===null){c.setLocalX(g)}}}}finally{_ssevt_(c,"move",false)}}}function _ssz_(d,a,b){if(d.collapsed){var f=d.collapsed;if(f=="left"||f=="right"){if(a!=d.getWidth()){d.expand(false)}}if(f=="top"||f=="bottom"){if(b!=d.getHeight()){d.expand(false)}}}d.setSize(a,b)}Ext.override(Ext.Component,{constructor:function(a){if(a&&a.beforeinit){a.beforeinit(this,a)}this.callParent([a])},uniCleanup:function(){try{if(this.nm){eval("delete "+this.nm+";");if(this===uniVars._actCnt){uniVars._actCnt=null}if(this===uniVars._mFrm_){uniVars._mFrm_=null}if(this===uniVars._actFrm_){uniVars._actFrm_=uniVars._mFrm_}}}catch(e){}},uniAfterCreate:function(){},uniCheckEvent:function(a){if(this.events[a]===true){this.uniHasEvent[a]=true}},destroy:function(){var a=this.isDestroyed;if(!a&&this.manualDestroy===true){return}try{this.uniDestroy()}finally{try{this.callParent()}finally{if(!a){this.uniCleanup()}}}},uniDestroy:function(){if(!this.isDestroyed){if(this.uform&&this.uform.tabItems){this.uform.tabItems.remove(this);if(this.uform.activeField===this){this.uform.activeField=null}}if(this.owner){if(this.rootObj){eval("delete "+this.owner.uname+";")}else{if(this.uname){this.owner[this.uname]=null}}}}},setPendingElProps:function(){if(this.elArray){var b=this.elArray;while(b.length>0){e=b.pop();this.setElProp(e.prop,e.val,e.mtd,e.cs,true,e.elname)}}},afterRender:function(){var a=this;a.callParent();a.initUniEvents();a.setPendingElProps()},initUniEvents:function(){},showMaskCfg:function(a,b){if(!this.maskActive){_shm_(this,true,b,a);this.maskActive=true}},showMask:function(d,c,b){if(!this.maskActive){var a=this;if(d){a.maskMsg=d;a.maskUseMsg=true}if(c){a.targetObj=c}else{if(this.uform){a.targetObj=this.uform}}_shm_(this,true,b,a);this.maskActive=true}},hideMask:function(a){this.maskActive=false;_hde_(this,a)},setElProp:function(a,d,l,h,k,j){var c=null;switch(l){case 0:case 1:case 2:case 3:case 4:case 5:if(j){c=this[j];if(Ext.isObject(c)&&c.isComponent){c=c.el}}else{if(this.getEl){c=this.getEl()}else{c=this.element}}break;case 6:if(this.getComponent){c=this.getComponent().element}break}if(c){switch(l){case 0:c.setStyle(a,d);break;case 1:c=c.down(h);if(c){c.setStyle(a,d)}break;case 2:if(c.dom){c.dom[a]=d}break;case 3:if(c.dom&&c.dom.style){c.dom.style[a]=d}break;case 4:if(this.setFieldStyle){if(d){this.setFieldStyle(a+":"+d)}else{this.setFieldStyle(a)}}break;case 5:var g=Ext.DomQuery.select(h,c.dom,null,false);if(g&&g.length){for(var f=0;f<g.length;f++){if(Ext.isObject(a)){for(var b in a){if(g[f].style){g[f].style[b]=a[b]}}}}}break;case 6:c=c.down(h);if(c){c=c.dom}if(c){c[a]=d}break}}if(!c&&k!==true){if(this.elArray==undefined){this.elArray=[]}this.elArray.push({prop:a,val:d,mtd:l,cs:h,elname:j})}},setBodyProp:function(c,b){var a=this.body;if(a){a.setStyle(c,b)}}});var _ajxerr=false;var _showAjaxErr=false;var _ajxflerr="Server unavailable, please try later";function AjaxError(a,b){if(_ajxerr){return}_ajxerr=true;Ext.Msg.show({title:"Ajax Error",multiline:true,value:b,width:400,minWidth:200,msg:a,icon:Ext.Msg.ERROR,buttons:Ext.Msg.OK,fn:function(){_ajxerr=false}})}function AjaxSuccess(rs){if(_aexc_(rs)){return}try{eval(rs.responseText)}catch(err){if(_showAjaxErr){AjaxError(err.message,rs.responseText)}}}function AjaxFailure(a,b){if(!uniSyncObj.fMode){AjaxError(_ajxflerr,"Error: "+a.statusText+"\x0AStatus: "+a.status)}}function _cunld_(){if(uniVars._mFrm_){ajaxRequest(uniVars._mFrm_,"bclose",[],false)}}function _sdl_(g){var a=uniVars._dlfrmarr;var c=a.length;if(c>=5){var b=a[0];a.shift();try{Ext.destroy(b)}catch(f){}}var d=Ext.DomHelper.append(document.body,{tag:"iframe",id:"__uniDlFrame_"+uniVars._dlfrmid++,name:"???????",frameBorder:0,width:0,height:0,css:"display:none;visibility:hidden;height:0px;",src:g},true);a.push(d);return d}function _clat_(){for(var a in uniVars._timers){if(uniVars._timers[a]!=null){try{uniVars._timers[a].uniStop();uniVars._timers[a]=null}catch(b){}}}}function _hed_(b){var a=_gmo_(b);if(a.nm){a.uniBlurChanged=true;if(!a.sendBusy){if(!a.fieldEdited){if(a.getValue&&a.getValue()==null){return}a.fieldEdited=true;a.fieldEditBusy=true;try{if(a.readOnly!==true){if(a.uname){_sfc_(a);a.fireEvent("edited",a)}}}finally{a.fieldEditBusy=false}}}}}function _gmo_(a){if(!a.nm&&a.ownerCt&&a.ownerCt.nm){a=a.ownerCt}return a}function _sfc_(b,a){if(b&&!b.focusDisabled||a){uniVars._actCnt=b}}function _rfes_(a){a.fieldEdited=false}Ext.define("uniIFrame",{getEditorBody:function(){var a=this.getDoc();return a.body||a.documentElement},getDoc:function(){return Ext.isIE?this.getWin().document:(this.iframe.contentDocument||this.getWin().document)},getWin:function(){return Ext.isIE?this.iframe.contentWindow:window.frames[this.iframe.name]},setUrl:function(a){this.lastUrl=a;if(this.iframe){this.iframe.src=a;this.fireEvent("urlchange",this,this.iframe)}},setValue:function(c,a){if(this.docInited){if(a===true){this.getEditorBody().innerHTML=c}else{var b=this.getDoc();b.open();b.writeln(c);b.close()}}else{this.fhtml=c;this.fhtmlOnly=a}},initEditor:function(){this.docInited=true;if(this.fhtml){this.setValue(this.fhtml,this.fhtmlOnly)}},initIFrame:function(c,b){if(this.iframe==undefined){var a=this.ifName;if(!a){a=this.config.ifName}if(a){this.iframe=document.getElementsByName(a)[0];if(this.iframe&&this.lastUrl){this.setUrl(this.lastUrl)}}}if(c&&this.lastUrl){this.fireEvent("frameload",this,b)}}});function _o2s_(g,c){var d="\4",b="",a,h;if(!Ext.isObject(g)){return(_xl_(g))}for(var f in g){a=g[f];if(c){h=c[f];if(a==null||a===h){continue}}a=_xl_(a);if(b!=""){b+=d}b=b+f+"="+a}return"{"+b+"}"}function _r2s_(c){var b="{";if(!Ext.isObject(c)){return(_xl_(c))}if(c.data){var f=c.data;for(var d in f){if(c.isModified(d)){var a=_xl_(f[d]);if(b!="{"){b+=","}b=b+d+":"+a}}}return b+"}"};